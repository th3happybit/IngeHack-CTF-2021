from base64 import b64decode
exec(b64decode("aW1wb3J0IGhhc2hsaWIKCgpTSUdOQVRVUkUgPSBbImQ3YWUxMTM2NDBjYWM1YjBjNjEwMTE0OTNmZDRjYThlIiwKICAgICAgICAgICAgICI4MjM1YjMxZmJhNjJlNDdlZmVkMDU2Yzc5NzA5MmJjMiIsICI5ZTgxMDExYzY5NGYyMmY2NWVjYzkwNzI4ZjQwZTE1YyIsICJiYmE3OGU3ZDNkNmVhNjk2YmZlZjZlODdhMjZhNmMwMyJdCgoKIyBJIHNpc3NvciB5b3UKIyBJIHBhcGVyIHlvdQojIEkgLi4uCgpkZWYgZW5jcnlwdDByQ2hlY2soc2VjcmV0KToKICAgIGkgPSAwCiAgICBmb3Igd29yZCBpbiBzZWNyZXQuc3BsaXQoYiJfIik6CiAgICAgICAgaWYgaGFzaGxpYi5tZDUod29yZCkuaGV4ZGlnZXN0KCkgIT0gU0lHTkFUVVJFW2ldOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICBpICs9IDEKICAgIHJldHVybiBUcnVlCgoKZGVmIENoZWNrU2VjcmV0KHNlY3JldCk6CiAgICBpZiBzZWNyZXRbOjldID09IGIiSW5nZUhhY2t7IiBhbmQgc2VjcmV0Wy0xXSA9PSAxMjUgYW5kIGVuY3J5cHQwckNoZWNrKHNlY3JldFs5Oi0xXSk6CiAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBGYWxzZQoKCmRlZiBtYWluKCk6CiAgICBzZWNyZXQgPSBvcGVuKAogICAgICAgICIvdG1wL3N5c3RlbWQtcHJpdmF0ZS1kNGNiMzFlMDRlNzY0MGIzOTBjOGY3NDI0YmI5NjQ4MC1tYXJpYWRiLnNlcnZpY2UtbHQ2YVUzL3RtcCIsICJyYiIpLnJlYWQoKS5zdHJpcCgpCiAgICBpZiBDaGVja1NlY3JldChzZWNyZXQpOgogICAgICAgIHByaW50KCJJdCdzIGZvciByZWFsISIpCiAgICBlbHNlOgogICAgICAgIHByaW50KCJUaGV5IGdvdCB1cyBpdCdzIGEgaG9uZXlwb3QhISEiKQoKCm1haW4oKQ=="))
