#include<stdio.h>
#include <openssl/sha.h>
#include <openssl/md5.h>
#include<math.h>
#include <string.h>

void sha256(char *string, char outputBuffer[65])
{
    unsigned char hash[SHA256_DIGEST_LENGTH];
    SHA256_CTX sha256;
    SHA256_Init(&sha256);
    SHA256_Update(&sha256, string, strlen(string));
    SHA256_Final(hash, &sha256);
    int i = 0;
    for(i = 0; i < SHA256_DIGEST_LENGTH; i++)
    {
        sprintf(outputBuffer + (i * 2), "%02x", hash[i]);
    }
    outputBuffer[64] = 0;
}
void md5(char *string, char outputBuffer[33])
{
    unsigned char hash[16];
    MD5_CTX MD5;
    MD5_Init(&MD5);
    MD5_Update(&MD5, string, 1);//strlen(string));
    MD5_Final(hash, &MD5);
    int i = 0;
    for(i = 0; i < 16; i++)
    {
        sprintf(outputBuffer + (i * 2), "%02x", hash[i]);
    }
    outputBuffer[32] = 0;
}
int nthPrime(int n){
 int c = 0, num = 2, i, letest = 0;

  while (c != n)
    {
      int count = 0;
      for (i = 2; i <= sqrt (num); i++)
 {
   if (num % i == 0)
     {
       count++;
       break;
     }
 }
      if (count == 0)
 {
   c++;
   letest = num;
 }
      num = num + 1;
    }
  return letest;
}
void HASHER(char *input,char output[65]){
    char result[33];
        md5(input,result);
        sha256(result,output);

}
char *Hashes[]={"ed6a7336a782fc5940318c4c82d826cacdfdd4a086f6122fed5ea0235f58ad62", "018328ddb09ee75b5b92e561b5469fa9ae068b19c21f40a73d656698632f47d6", "c356e0006c694856e8ead5cd673cbbe74590e011d869675ccec0a8ba72b1c16c", "018328ddb09ee75b5b92e561b5469fa9ae068b19c21f40a73d656698632f47d6", "4138d95924c019274d7de2c329ffab4e1ed009cac6e0c4dd29bab4839adc2aec", "8570cd56d526f492320d3f61ec76e6dad426f17be01be6677314dfd5f9c21d91", "9b0b7edebf85f1aef852317066b0acbc35db0fd3c36c00daf67f961c0d1e8574", "eb1ef9d0ad6f467ff13563a3c33da3c0c35fb892d08e35f8eda62c27d3c4584b", "01ef3c14db0794cc619b08c34c27cca45b815f3b7bd088490f77427e964dbd30", "7b650feac6de89138d48f08bd11d8d3b81977a4e005f30cbdf6feaa969cd9708", "ed6a7336a782fc5940318c4c82d826cacdfdd4a086f6122fed5ea0235f58ad62", "35cd62e58b0c721dc9745cac5f371c21dcc852d7b5d461c5bab63daebf60ee8b", "418dd73df63bfe1dc9b1d126d340ccf4941198ccf573eff190a6ff8dc69e87e4", "68e2ad09f9351a3dd2a8769e3da82bb3d95899c02ba5d63fdc3dc77cacf3b2eb", "cd6828879d18ac6bfbae963afc6de68ab20d25cadd5428260c5561ce668c9601", "ee8d495a7c56b7b413bbf86373a5d9da1f7e8aeb514a4c608e8fff1d43b17fa7", "8570cd56d526f492320d3f61ec76e6dad426f17be01be6677314dfd5f9c21d91", "7b650feac6de89138d48f08bd11d8d3b81977a4e005f30cbdf6feaa969cd9708", "cdd563f9c7a8016e3856afec1c3f8eeb69f6998fab4c4de902e6beb53217d895", "301ce778eee4199bd078598f54258286a070257dc39214e623a608f60ba18bd5", "018328ddb09ee75b5b92e561b5469fa9ae068b19c21f40a73d656698632f47d6", "75539a767ac4210ea775b555d951885067d8d28aa781fcaa527f144cf4cee45e", "825682958e1f140c291eb677212a068a9311a81d74bc4375e87c504e4946a0ab", "3b21793574b09fda6f18ffb793a350af7605937a16ad33e4eeba696eb6b332f1", "480a8f78a0f2799d2b81423240b94a0efce881cb479157f811dd75938ee9ccbd", "a200779402d76af34f32c421c11eca575d769559db4589868b19cf2e7d37d936", "213fc6e960996a1d80bca1c970e9b29b2df407341acc5f36c5e7039383ac4131", "5c18188eb444bda1d2ff3a9ac85fe440c386a48d32e5bd7be9f304a60c73ada0", "e89f38039ee41ccb137879a1d1f237f5f3679ab0dea961e78d77d48becfc7766", "5f8674997099956a6780c61aa65b77f7ecb6b2b1b02369f1446eb903931a7f1a", "a5464d3ec86e75cf3f92718acdd91577acc1d59f4b4418f91a03ac8c76cec681", "83a90a9396831160ec6edd8102d0bae0d73317e84dfe79742c2d0592edb04484", "03f8798a99f4a81b8b4def0f22459c0c3085ce969b1706fcd77b96e202d00ede", "dd7c578c77570400df1524b9a21769859047990a062594a9906b6137b6462281", "a2b1e340649f42ec28f25289ccd323e2e9d637c4a699eb03210f80ff523c8353", "0da9b19aa44419cd1c922282d006144a82800af7be228e614afc6eec81290094", "e89f38039ee41ccb137879a1d1f237f5f3679ab0dea961e78d77d48becfc7766", "3b1fe7df934f502b4b7bd489270329c61df2c608be66297203577a45830158bf", "6b856a7bfd1c47f0488c8de6ac57bf5fcd300802db8f15fa020ca4963f02137d", "c28e1316f6231ba322f55e6d4456669f1cd3685b9bc0e7fdfbdd4b4ef110462a", "c356e0006c694856e8ead5cd673cbbe74590e011d869675ccec0a8ba72b1c16c", "cc1807dc8bf0d4ffc59e27a7a0b43220a60e976136a35b333eba2e8bc13815cb", "1167f8aa191053d77f7eaa6935ec644e03490ea1c1cf98037609bbd23bc61ec0", "6b752480911b6e43e6a78a4fe020f13abc5df6ddcb9bf0c33ab401c3c327a1f4", "ed6a7336a782fc5940318c4c82d826cacdfdd4a086f6122fed5ea0235f58ad62", "da2395a9a6b64edbef09f15d21140766b61770c8cff8799d4bbf15efe842f33d", "a24b7ab10532f563fa436f59c068736fa29f3eee46012f5e9992b98f1cbee96f", "ce6fbe672b4d220515c872fc9eb2b3c5a75a094f5021274e8d37dd02ff322127", "213fc6e960996a1d80bca1c970e9b29b2df407341acc5f36c5e7039383ac4131", "48ba6cc589287142357ab399d7a116742512731bfd3177dba643ef2c861a6409", "fe2865ed6980cc0726884e8207b214408c3cbd0d32153d19a8bdc63fe6e1ad42", "036924e9956024883c5b711844ac2f7a05576813d021e4040d85a66497075992", "db2d8e82412b775f358732deba189805318d3bb40008c333171f078dcd4be0b8", "270b28aafffc9563ba2ab6446e34e331b86f4377f6bf0fc6021eac4ce038b959", "4ffc91dba1f54fcfafeece85ab3b93369d67dd2efc9f05980342e627b4a97737", "dd5e33d9fe6f5ca8c1bb1dd6c7007f47543d32be4766815f05d10d1d70b82c8c", "301ce778eee4199bd078598f54258286a070257dc39214e623a608f60ba18bd5", "1344753c604c4f994a6a428dfca4698408cbbd50ac019f34d13eb2aa64ecf713", "abf99d7cb1e4a40ae8bff9a926c3ef36b52e6065f1105ea1d905d39049d38046", "5c18188eb444bda1d2ff3a9ac85fe440c386a48d32e5bd7be9f304a60c73ada0", "c356e0006c694856e8ead5cd673cbbe74590e011d869675ccec0a8ba72b1c16c", "4503eee237d15f4cc35fade160793df994521824c9e5514d128b9ee3cf0781d3", "68c0712c033bd74687b79d7c2c11fd74eaf2b71e9455d75ef80812a1c18a79f1", "403dd45c5e49532f648e756d9178b73467a741444a321d2e0755ebde19ac8523", "cdd563f9c7a8016e3856afec1c3f8eeb69f6998fab4c4de902e6beb53217d895", "36b5b9b5dfa1a235732060fe3c63cae934c080a872866e6d52c8889c18305c6b", "1167f8aa191053d77f7eaa6935ec644e03490ea1c1cf98037609bbd23bc61ec0", "018328ddb09ee75b5b92e561b5469fa9ae068b19c21f40a73d656698632f47d6", "403dd45c5e49532f648e756d9178b73467a741444a321d2e0755ebde19ac8523", "5f8674997099956a6780c61aa65b77f7ecb6b2b1b02369f1446eb903931a7f1a", "8570cd56d526f492320d3f61ec76e6dad426f17be01be6677314dfd5f9c21d91", "787ef811dc588e955c76e8ad3cf14485460d4030bedb99a13b23779236c3473b", "db2d8e82412b775f358732deba189805318d3bb40008c333171f078dcd4be0b8", "e1948415a100a724196e9759988f24d5bf0bb44d3ead4cdee4d02695916710ac", "68e2ad09f9351a3dd2a8769e3da82bb3d95899c02ba5d63fdc3dc77cacf3b2eb", "35cd62e58b0c721dc9745cac5f371c21dcc852d7b5d461c5bab63daebf60ee8b", "a200779402d76af34f32c421c11eca575d769559db4589868b19cf2e7d37d936", "018328ddb09ee75b5b92e561b5469fa9ae068b19c21f40a73d656698632f47d6", "893793af9d01f378416fa7aa0b2f6bebaa166c1ee03b3e645319f757d6b27fef", "75539a767ac4210ea775b555d951885067d8d28aa781fcaa527f144cf4cee45e", "2f4949c613203ab327e46b8d56e3e181c2d45f1c34c9f4406fd1f71f738f67a8", "908ba69afb21a8b1fdede84237cb93ca163834b6cee00e7b025eb1d5f605e783", "9da114d1ac5ba27ac496b2a312e3788f6ca8be15867233c3469398fdc037634e", "cc1807dc8bf0d4ffc59e27a7a0b43220a60e976136a35b333eba2e8bc13815cb", "68e2ad09f9351a3dd2a8769e3da82bb3d95899c02ba5d63fdc3dc77cacf3b2eb", "574c8db8f97d363c340a33ee2de4ca51bd094f6ee8b8e55d47983963c9fef966", "ae17a92b68a3f0ff9e97b75b2eb9856920170f230c8996b2a20efab76bf76538", "3bb41315c0470caadb8820d4cb1409d870f3e0cf5d54954de4d18c38483eb641", "08428467285068b426356b9b0d0ae1e80378d9137d5e559e5f8377dbd6dde29f", "2c0a4e0b13245967f73430247edce6de977a0b94e2ca2b0c29ceac2ab14e600f", "e1948415a100a724196e9759988f24d5bf0bb44d3ead4cdee4d02695916710ac", "3f515b0e944598d03f5cb197d56dbd835720e02cd2305c5e27f09cf805efead7", "a5464d3ec86e75cf3f92718acdd91577acc1d59f4b4418f91a03ac8c76cec681", "6f3a8dc0c44c0c8717e9b24bdea782439b701318f4403b9c9ee331a29220dbca", "dd5e33d9fe6f5ca8c1bb1dd6c7007f47543d32be4766815f05d10d1d70b82c8c", "418dd73df63bfe1dc9b1d126d340ccf4941198ccf573eff190a6ff8dc69e87e4", "c356e0006c694856e8ead5cd673cbbe74590e011d869675ccec0a8ba72b1c16c", "604133ce8d72e33259a8662ebcb48bc12ffa64f8658d8c6918040f7653909a7f", "ae17a92b68a3f0ff9e97b75b2eb9856920170f230c8996b2a20efab76bf76538", "950d88109fe09c5f7da6c35d8a0c99876c1637522d7eeaa49f412092e5d88bbe", "3f515b0e944598d03f5cb197d56dbd835720e02cd2305c5e27f09cf805efead7", "00ed7b6848e2586283aadd1eacccd7e2df8896244dd183a481d2bbcaa26dd160", "1167f8aa191053d77f7eaa6935ec644e03490ea1c1cf98037609bbd23bc61ec0", "0da9b19aa44419cd1c922282d006144a82800af7be228e614afc6eec81290094", "a5464d3ec86e75cf3f92718acdd91577acc1d59f4b4418f91a03ac8c76cec681", "c28e1316f6231ba322f55e6d4456669f1cd3685b9bc0e7fdfbdd4b4ef110462a", "9da114d1ac5ba27ac496b2a312e3788f6ca8be15867233c3469398fdc037634e", "2c0a4e0b13245967f73430247edce6de977a0b94e2ca2b0c29ceac2ab14e600f", "db2d8e82412b775f358732deba189805318d3bb40008c333171f078dcd4be0b8", "ea24e72cb6671bb253ae0a95d38758a8680601de072cc951b9aef8c758eaaf0e", "cd6828879d18ac6bfbae963afc6de68ab20d25cadd5428260c5561ce668c9601", "ed6a7336a782fc5940318c4c82d826cacdfdd4a086f6122fed5ea0235f58ad62", "1167f8aa191053d77f7eaa6935ec644e03490ea1c1cf98037609bbd23bc61ec0", "1167f8aa191053d77f7eaa6935ec644e03490ea1c1cf98037609bbd23bc61ec0", "35cd62e58b0c721dc9745cac5f371c21dcc852d7b5d461c5bab63daebf60ee8b", "ee8d495a7c56b7b413bbf86373a5d9da1f7e8aeb514a4c608e8fff1d43b17fa7", "5bd4e083d0018fedf68aa98d2a4b8a899dc5e2e178554c0350df69bbfaac85d4", "08428467285068b426356b9b0d0ae1e80378d9137d5e559e5f8377dbd6dde29f", "35cd62e58b0c721dc9745cac5f371c21dcc852d7b5d461c5bab63daebf60ee8b", "dd7c578c77570400df1524b9a21769859047990a062594a9906b6137b6462281", "fe2865ed6980cc0726884e8207b214408c3cbd0d32153d19a8bdc63fe6e1ad42", "3f01e82551f0cfa79ef1857f1106f7a6a1514563c55d98dec844d93009a7aaed", "68c0712c033bd74687b79d7c2c11fd74eaf2b71e9455d75ef80812a1c18a79f1", "83a90a9396831160ec6edd8102d0bae0d73317e84dfe79742c2d0592edb04484", "83a90a9396831160ec6edd8102d0bae0d73317e84dfe79742c2d0592edb04484", "930ab447d13d64841af460fd855341aa0a0727fb6da9343922ec83d9e5d2ad83", "08428467285068b426356b9b0d0ae1e80378d9137d5e559e5f8377dbd6dde29f", "cd6828879d18ac6bfbae963afc6de68ab20d25cadd5428260c5561ce668c9601", "abf99d7cb1e4a40ae8bff9a926c3ef36b52e6065f1105ea1d905d39049d38046", "a5464d3ec86e75cf3f92718acdd91577acc1d59f4b4418f91a03ac8c76cec681", "3f515b0e944598d03f5cb197d56dbd835720e02cd2305c5e27f09cf805efead7", "249654783a9846267c86af2c19d7962d88bd02859a4b3fe32fd023a2f25b77a6", "0da9b19aa44419cd1c922282d006144a82800af7be228e614afc6eec81290094", "e1948415a100a724196e9759988f24d5bf0bb44d3ead4cdee4d02695916710ac", "83a90a9396831160ec6edd8102d0bae0d73317e84dfe79742c2d0592edb04484", "c30993dc6672f65a3f2e7a970095eac0ebddfd9a918c07f9153e64b3d04a0c8c", "a3bf48eeb53eec704074b03d30d2fa4faa3bfb79b0cfa4df6eb3b959e2da0018"};

int main(int argc, char* argv[]){
    printf("Input the flag:");
    char flag[50];
    char result[65];
    int flagCorrect = 1;
    fgets(flag,34,stdin);
    for(int i=0;i<strlen(flag);i++){
        HASHER(&flag[i],result);
        if(strcmp(result,Hashes[nthPrime(i+1)-1])!=0){
          flagCorrect=0;
        }

    }
    if(flagCorrect == 1){
      puts("Congragulations you got the right flag!\n");
    }else{
      puts("Nope, I told you hashes are safe!!\n");
    }

    return 0;
}